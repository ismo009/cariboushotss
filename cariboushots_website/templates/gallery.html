{% extends "base.html" %}

{% block title %}
    {% if current_folder_name %}
        {{ current_folder_name }} - Galerie
    {% else %}
        Galerie Photo
    {% endif %}
{% endblock %}

{% block content %}
<div class="gallery-container">
    <h2>Galerie Photo du Club</h2>

    <h3>
        Actuellement dans :
        <a href="{{ url_for('gallery', folder_id=current_folder_id if current_folder_id != MAIN_CLUB_FOLDER_ID else None) }}">
            {{ current_folder_name }}
        </a>
    </h3>

    {# Back navigation link #}
    {% if current_folder_id != MAIN_CLUB_FOLDER_ID %} {# Only show 'Back' if not in the root of the gallery #}
        <div class="back-navigation">
            <a href="{{ url_for('gallery', folder_id=parent_folder_id if parent_folder_id else None) }}" class="back-link">
                <span class="back-arrow">←</span>
                <span class="back-text">
                    Retour vers
                    {% if parent_folder_id %}
                        le dossier précédent
                    {% else %}
                        la Galerie Principale
                    {% endif %}
                </span>
            </a>
        </div>
    {% endif %}

    {% if folders %}
        <h4>Sous-dossiers :</h4>
        <ul class="folder-list">
            {% for folder in folders %}
                <li>
                    <a href="{{ url_for('gallery', folder_id=folder.id) }}">{{ folder.name }}</a>
                    <small class="text-muted"> (ID: {{ folder.id }})</small> {# Optional: for debugging #}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>Aucun sous-dossier trouvé dans {{ current_folder_name }}.</p>
    {% endif %}

    <hr>

    {% if photos %}
        <h4>Photos dans {{ current_folder_name }} :</h4>
        <div class="photo-grid">
            {% for photo in photos %}
                <div class="photo-item">
                    <a href="{{ photo.webViewLink if photo.webViewLink else '#' }}" target="_blank" title="Voir '{{ photo.name }}' sur Google Drive">
                        {# Use a placeholder if thumbnailLink is missing, or if it's known to be problematic #}
                        <img src="{{ photo.thumbnailLink if photo.thumbnailLink else url_for('static', filename='images/placeholder_image.png') }}"
                             alt="{{ photo.name }}"
                             onerror="this.onerror=null; this.src='{{ url_for('static', filename='images/placeholder_image.png') }}';"> {# Fallback if thumbnail fails to load #}
                        <p>{{ photo.name }}</p>
                    </a>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>Aucune photo trouvée dans {{ current_folder_name }}.</p>
    {% endif %}

</div>
{% endblock %}
